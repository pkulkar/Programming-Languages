<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    //border:1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style>
</head>
<body onload="startGame()">
<script>
var wide=0;
var wide1=0;
var wide2=0;
var wide3=0;
var wide4=0;
var wide5=0;
var wide6=0;
var wide7=0;
var wide8=0;
var wide9=0;
var wide10=0;

var myGamePiece=[];
var myprevious=[];
var a=Math.floor(Math.random()*4)
	if(a==0)
	myGamePiece.push(new component(20, 20, "red", 40, 0));
	if(a==1)
	myGamePiece.push(new component(40, 20, "red", 40, 0));
	if(a==2)
	myGamePiece.push(new component(60, 20, "red", 40, 0));
	if(a==3)
	myGamePiece.push(new component(80, 20, "red", 40, 0));	
/*myGamePiece[0] = new component(20, 20, "red", 40, 0);
myGamePiece[1] = new component(40, 20, "red", 40, 0);
myGamePiece[2] = new component(60, 20, "red", 40, 0);
myGamePiece[3] = new component(80, 20, "red", 40, 0);*/
var flag=0;
var i=0;
var flag2=0;
function startGame() {
myGamePiece[i];
    
	 
	
	//myGamePiece[1] = new component(40, 20, "red", 40, 0);
    myGameArea.start();
}

var myGameArea = {
    canvas : document.createElement("canvas"),
    start : function() {
        this.canvas.width = 180;
        this.canvas.height = 240;
        this.context = this.canvas.getContext("2d");
        document.body.insertBefore(this.canvas, document.body.childNodes[0]);
        this.interval = setInterval(updateGameArea, 20);
    },
    clear : function() {
        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    },
	 stop : function() {
        clearInterval(this.interval);
		}
}

function component(width, height, color, x, y) {
    this.width = width;
    this.height = height;
    this.x = x;
    this.y = y;   
	this.speedX=0;
	this.speedY=0;
    this.update = function(){
        ctx = myGameArea.context;
        ctx.fillStyle = color;
        ctx.fillRect(this.x, this.y, this.width, this.height);
    }
	this.newpos = function() {
		this.y+=1;
       // this.x =this.x;
        
		this.hitleft();
		this.hitright();
		this.hitbottom();
		if(flag2==1)
		{
		flag2=0;
		if(this.y==200){
				wide1=wide1+this.width;
				if(wide1==180)
				{
				this.clearrow(this.y);
				}
				}
				
		if(this.y==180){
		wide2=wide2+this.width;
		if(wide2==180)
			{
			this.clearrow(this.y);
			}
		}
		
		if(this.y==160){
		wide3=wide3+this.width;
		if(wide3==180)
			{
			this.clearrow(this.y);
			}
		}
		
		if(this.y==140){
		wide4=wide4+this.width;
		if(wide4==180)
			{
			this.clearrow(this.y);
			}
		}
		
		if(this.y==120){
		wide5=wide5+this.width;
		if(wide5==180)
			{
			this.clearrow(this.y);
			}
		}
		
		if(this.y==100){
		wide6=wide6+this.width;
		if(wide6==180)
			{
			this.clearrow(this.y);
			}
		}
		if(this.y==80){
		wide7=wide7+this.width;
		if(wide7==180)
			{
			this.clearrow(this.y);
			}
		}
		if(this.y==60){
		wide8=wide8+this.width;
		if(wide8==180)
			{
			this.clearrow(this.y);
			}
		}
		if(this.y==40){
		wide9=wide9+this.width;
		if(wide9==180)
			{
			this.clearrow(this.y);
			}
		}
			if(this.y==20){
		wide10=wide10+this.width;
		if(wide10==180)
			{
			this.clearrow(this.y);
			}
		}
		}
		
		
    }    
	this.hitbottom=function(){
	var last=myGameArea.canvas.height-this.height;
	if(i>0){
	for(i=0;i<myprevious.length;i++)
		{
			var lastt=myprevious[i].y-this.height;
			 var myleft = myprevious[i].x;
			var myright = myprevious[i].x + myprevious[i].width;
			if(this.y>lastt )
			{
				if(((this.x < myright)&&(this.x>myprevious[i].x)) || (((this.x+this.width)>myprevious[i].x)&& ((this.x+this.width)<(myright))))
				{
				flag=1;
				this.y=lastt;
				flag2=1;
				}
				if(((this.x < myright)&&(this.x>myprevious[i].x)) || (((this.x+this.width)>myprevious[i].x)&& ((this.x+this.width)<(myright))))
				{
				flag=1;
				this.y=lastt;
				flag2=1;
				}
				if(myGamePiece[i]==myprevious[i]&&this.x==myprevious[i].x)
				{
				flag=1;
				this.y=lastt;
				flag2=1;
				}
				if((myprevious[i].x+myprevious[i].width)==(this.x+this.width))
				{
				flag=1;
				this.y=lastt;
				flag2=1;
				}
				if(((this.y+this.height)==myprevious[i].y) &&(this.y+this.height)==0)
				{
				alert("Game over");
				myGameArea.stop();
				}	
			}
		}
			
																																			
	}
	
	if(this.y>last)
		{
	this.y=last;
	flag=1;	
	wide=wide+this.width;
	if(wide==180)
	{
	this.clearrow(this.y);
	}
	}
	

	
	}
	this.hitleft=function(){
	
	if(this.x<0) {
		this.x=0;
	
	}
	
	
	}
	this.hitright=function(){
	
	if(this.x+this.width>180) {
		this.x=180-this.width;
	}
	
	}
	
	this.clearrow=function(d){
	myGamePiece.splice(i,1);
	myprevious.splice(i,1);
	i--;
	var count=0;

	/*Line 12 Break*/
		if(d==220)
		{
			wide=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				myprevious[j].y+=20;
				var last=myGameArea.canvas.height-myprevious[j].height;
				if(myprevious[j].y==last)
				{
				wide=wide+myprevious[j].width;}
				}
			}		
		}
	/* Line 12 Break done*/
	
	/*Line 11 Break*/
		if(d==200)
		{
			wide1=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=180)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==200)
						{
					wide1=wide1+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 11 Break done*/
	
	/*Line 10 Break*/
		if(d==180)
		{
			wide2=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=160)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==180)
						{
					wide2=wide2+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 10 Break done*/
	
	/*Line 9 Break*/
		if(d==160)
		{
			wide3=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=140)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==160)
						{
					wide3=wide3+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 9 Break done*/
	
	/*Line 8 Break*/
		if(d==140)
		{
			wide4=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=120)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==140)
						{
					wide4=wide4+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 8 Break done*/

/*Line 7 Break*/
		if(d==120)
		{
			wide5=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=100)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==120)
						{
					wide5=wide5+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 7 Break done*/
	
	/*Line 6 Break*/
		if(d==120)
		{
			wide6=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=80)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==100)
						{
					wide6=wide6+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 6 Break done*/
	
	/*Line 5 Break*/
		if(d==100)
		{
			wide7=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=60)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==80)
						{
					wide7=wide7+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 5 Break done*/
	
	/*Line 4 Break*/
		if(d==80)
		{
			wide8=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=40)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==60)
						{
					wide8=wide8+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 4 Break done*/
	
	/*Line 3 Break*/
		if(d==60)
		{
			wide9=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=20)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==40)
						{
					wide9=wide9+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 3 Break done*/
	
	/*Line 2 Break*/
		if(d==40)
		{
			wide10=0;
		for(j=myprevious.length-1;j>-1;j--)
			{
			if(myprevious[j].y==d)
				{
				myprevious.splice(j,1);
				myGamePiece.splice(j,1);
				count++;
				}
			else{
				if(myprevious[j].y<=0)
					{
					myprevious[j].y+=20;
					if(myprevious[j].y==20)
						{
					wide10=wide10+myprevious[j].width;
						}
					}							
				}
			}		
		}
	/* Line 3 Break done*/
	
		flag=1;
		i=(i-count);
	}
}



function updateGameArea() {
    myGameArea.clear();
    if(i>0){
    for(j=0;j<=i;j++){
	  myGamePiece[j].update();
	  }}
	  if(flag==1){
	flag=0;
	
	z=Math.floor(Math.random()*4)
	if(z==0)
	myGamePiece.push(new component(20, 20, "red", 40, 0));
	if(z==1)
	myGamePiece.push(new component(40, 20, "red", 40, 0));
	if(z==2)
	myGamePiece.push(new component(60, 20, "red", 40, 0));
	if(z==3)
	myGamePiece.push(new component(80, 20, "red", 40, 0));	
	myprevious[i]=myGamePiece[i];
	i++;
	}
	if(i>0||flag!=1){
	myGamePiece[i].newpos();
	myGamePiece[i].update();
	}
}
function moveleft() {
    myGamePiece[i].x -= 20; 
}

function moveright() {
    myGamePiece[i].x+= 20; 
}
function clearmove() {
    myGamePiece[i].speedX = 0; 
    myGamePiece[i].speedY = 0; 
}
</script>
<p></p>
<div style="text-align:center;width:480px;">
 
  <button onmousedown="moveleft()" onmouseup="clearmove()" ontouchstart="moveleft()">LEFT</button>
  <button onmousedown="moveright()" onmouseup="clearmove()" ontouchstart="moveright()">RIGHT</button><br><br>
 
</div>
</body>
</html>


